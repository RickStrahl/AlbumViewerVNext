!function(){"use strict";var e=angular.module("app",["ngAnimate","ngRoute","ngSanitize"]);e.configuration={useLocalData:!1},e.config(["$routeProvider",function(e){e.when("/albums",{templateUrl:"app/views/albums.html"}).when("/album/edit/:albumId",{templateUrl:"app/views/editalbum.html"}).when("/album/:albumId",{templateUrl:"app/views/album.html"}).when("/artists",{templateUrl:"app/views/artists.html"}).when("/artist/:artistId",{templateUrl:"app/views/artist.html"}).when("/about",{templateUrl:"app/views/about.html"}).otherwise({redirectTo:"/albums"})}]).filter("linebreakFilter",function(){return function(e){return void 0!==e?e.replace(/\n/g,"<br />"):e}})}(),function(){"use strict";function e(e,t,n,a){function r(e){var e=e.toLowerCase();u.searchVisible="albums"==e||"artists"==e?!0:!1,console.log(u.searchVisible)}var u=e;u.searchText="",u.searchVisible=!1,u.activeTab=a.activeTab,u.onKey=function(){e.$emit("onsearchkey",u.searchText)},e.searchBlur=function(){u.searchText=""},u.$on("$locationChangeSuccess",function(){var e=n.location.hash;u.activeTab=e.extract("#/","/",!0),r(u.activeTab),console.log(e,u.activeTab)})}function t(e,t){console.log("artists controller");var n=this;n.artists=[],n.searchText="",n.baseUrl="api/",n.getArtists=function(){return t.get(n.baseUrl+"artists").success(function(e){n.artists=e})},e.$root.$on("onsearchkey",function(e,t){n.searchText=t}),n.getArtists()}angular.module("app").controller("headerController",e).controller("artistsController",t),e.$inject=["$scope","$route","$window","albumService"],t.$inject=["$scope","$http"]}(),function(){"use strict";function e(e,t,n,a){var r=this;r.album=null,r.selectedArtist={ArtistName:null,Description:null},r.error={message:null,icon:"warning",reset:function(){r.error={message:"",icon:"warning"}}},r.isSongVisible=!1,r.song={Id:0,AlbumId:0,Name:null,Length:null},r.saveAlbum=function(e){console.log(e),a.saveAlbum(e).success(function(e){r.error.message="Album saved",r.error.icon="info",setTimeout(function(){t.location.hash="/album/"+e.Id},1e3)}).error(function(){r.error.message="Album saved",r.error.icon="warning"})},r.addSong=function(){r.isSongVisible=!0,r.song={Id:0,AlbumId:a.album.Id,Name:null,Length:null},setTimeout(function(){$("#SongName").focus()},300)},r.saveSong=function(e){a.addSongToAlbum(r.album,e),r.albums=a.albums,r.album=a.album,r.isSongVisible=!1},r.cancelSong=function(){r.isSongVisible=!1},r.removeSong=function(e){console.log(e),a.removeSong(r.album,e),r.album=a.album},r.deleteAlbum=function(e){confirm("Are you sure you want to delete this album?")&&a.deleteAlbum(e).success(function(){r.albums=a.albums,$location.path("#/albums")}).error(onPageError)},r.getAlbum=function(e){a.getAlbum(e,!0).success(function(e){r.album=e})},r.bandTypeAhead=function(){var e=$("#BandName");e.typeahead({source:[],autoselect:!0}),e.keyup(function(){var t=$(this).val();$.getJSON("../api/artistlookup?search="+t,function(t){console.log(t),e.data("typeahead").source=t})})},r.getAlbum(1*e.albumId,!0),r.bandTypeAhead(),n.addClass("#MainView","slide-animation")}var t=angular.module("app").controller("albumController",e);e.$inject=t.configuration.useLocalData?["$routeParams","$window","$animate","albumServiceLocal"]:["$routeParams","$window","$animate","albumService"]}(),function(){"use strict";function e(e,t){function n(){return{Id:0,ArtistId:0,Tracks:[],Artist:{Id:0,ArtistName:null},Title:null,AmazonUrl:null,ImageUrl:null}}function a(){return{Id:0,SongName:null,Length:null}}function r(n){return!n&&b.albums&&b.albums.length>0?ww.angular.$httpPromiseFromValue(t,b.albums):e.get(b.baseUrl+"albums/").success(function(e){b.albums=e}).error(onPageError)}function u(n,a){if(0===n||"0"===n)return b.album=b.newAlbum(),ww.angular.$httpPromiseFromValue(t,b.album);if(-1===n||"-1"===n||!n)return ww.angular.$httpPromiseFromValue(t,b.album);if(b.album&&a&&b.album.pk==n){var r=ww.angular.deferredExtender(t.defer());return r.resolve(b.album),r.promise}return e.get(b.baseUrl+"album/"+n).success(function(e){b.album=e}).error(function(e,t,n,a){console.log(e,a)})}function l(e,t){e.Tracks.push(t),b.album=e}function o(e,t){var n=c(e);if(-1!=n){var a=b.albums[n];a.Tracks=_.remove(a.Tracks,function(e){return e.Id!=t.Id}),b.album=a}}function s(e){var t=c(e);t>-1?b.albums[t]=e:(b.albums.push(e),b.albums=_.remove(b.albums,function(){return 0==e.Id})),b.album=e}function i(t){return e.post(b.baseUrl+"album",t).success(function(e){b.updateAlbum(e),b.album=e})}function m(t){return e.get(b.baseUrl+"deletealbum/"+t.Id).success(function(){b.albums=_.remove(b.albums,function(e){return t.Id!=e.Id})})}function c(e){return _.findIndex(b.albums,function(t){return e.Id==t.Id})}var b={baseUrl:"api/",albums:[],artists:[],album:n(),getAlbums:r,getAlbum:u,updateAlbum:s,saveAlbum:i,deleteAlbum:m,addSongToAlbum:l,removeSong:o,newAlbum:n,newSong:a,activeTab:"albums"};return b}angular.module("app").factory("albumService",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t){function n(){return{Id:0,ArtistId:0,Tracks:[],Artist:{Id:0,ArtistName:null},Title:null,AmazonUrl:null,ImageUrl:null}}function a(){return{Id:0,SongName:null,Length:null}}function r(n){return!n&&d.albums&&d.albums.length>0?ww.angular.$httpPromiseFromValue(t,d.albums):e.get(d.baseUrl+"albums.js").success(function(e){d.albums=e}).error(onPageError)}function u(e,n){if(0===e||"0"===e)return d.album=d.newAlbum(),ww.angular.$httpPromiseFromValue(t,d.album);if(-1===e||"-1"===e||!e)return ww.angular.$httpPromiseFromValue(t,d.album);if(d.album&&n&&d.album.pk==e)return ww.angular.$httpPromiseFromValue(t,d.album);if(d.albums&&d.albums.length>0){var a=b(e);if(!a)return ww.angular.$httpPromiseFromValue(t,new Error("Couldn't find album"),!0)}var r=ww.angular.$httpDeferredExtender(t.defer());return d.getAlbums().success(function(){d.album=b(e),d.album?r.resolve(d.album):r.reject(new Error("Couldn't find album"))}).error(function(){r.reject(new Error("Couldn't find album"))}),r.promise}function l(e,t){e.Tracks.push(t),d.album=e}function o(e,t){var n=c(e);if(-1!=n){var a=d.albums[n];a.Tracks=_.remove(a.Tracks,function(e){return e.Id!=t.Id}),d.album=a}}function s(e){var t=c(e);t>-1?d.albums[t]=e:(d.albums.push(e),d.albums=_.remove(d.albums,function(){return 0==e.Id})),d.album=e}function i(t){return e.post(d.baseUrl+"album",t).success(function(e){d.updateAlbum(e),d.album=e})}function m(t){return e.get(d.baseUrl+"deletealbum/"+t.Id).success(function(){d.albums=_.remove(d.albums,function(e){return t.Id!=e.Id})})}function c(e){return _.findIndex(d.albums,function(t){return e.Id==t.Id})}function b(e){return _.find(d.albums,function(t){return e===t.Id})}var d={baseUrl:"data/",albums:[],artists:[],album:n(),getAlbums:r,getAlbum:u,updateAlbum:s,saveAlbum:i,deleteAlbum:m,addSongToAlbum:l,removeSong:o,newAlbum:n,newSong:a,activeTab:"albums"};return d}angular.module("app").factory("albumServiceLocal",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t){var n=this;n.albums=null,n.error={message:null,icon:"warning",reset:function(){n.error={message:"",icon:"warning"}}},n.searchText="",n.artistpk=0,n.albumClick=function(e){window.location="#/album/"+e.Id},n.getAlbums=function(){t.getAlbums().success(function(e){n.albums=e}).error(function(){alert("failed to get albums")})},n.addAlbum=function(){t.album=t.newAlbum(),t.updateAlbum(t.album),window.location="#/album/edit/"+t.album.Id},n.deleteAlbum=function(e){confirm("Are you sure you want to delete this album?")&&t.deleteAlbum(e).success(function(){n.albums=t.albums}).error(onPageError)},n.albumsFilter=function(e){var t=n.searchText.toLowerCase();return e&&e.Title&&(e.Title.toLowerCase().indexOf(t)>-1||e.Artist.ArtistName.toLowerCase().indexOf(t)>-1)?!0:!1},e.$root.$on("onsearchkey",function(e,t){n.searchText=t}),n.getAlbums()}var t=angular.module("app").controller("albumsController",e);e.$inject=t.configuration.useLocalData?["$scope","albumServiceLocal"]:["$scope","albumService"]}(),function(){"use strict";function e(e,t,n,a,r){var u=this;u.artist=null,u.baseUrl="api/",u.albums=[],u.error={message:null,icon:"warning",reset:function(){u.error={message:"",icon:"warning"}},show:function(e,t){u.error.message=e,u.error.icon=t?t:"warning"}},u.getArtist=function(t){e.get(u.baseUrl+"artist?id="+t).success(function(e){u.artist=e.Artist,u.albums=e.Albums}).error(function(){u.error.show("Artist couldn't be loaded.","warning")})},u.saveArtist=function(t){e.post(u.baseUrl+"artist/",t).success(function(e){u.artist=e.Artist,u.albums=e.Albums,$("#EditModal").modal("hide")}).error(function(){u.error.show("Artist couldn't be saved.","warning")})},u.albumClick=function(e){t.location.hash="/album/"+e.Id},u.addAlbum=function(){r.album=r.newAlbum(),r.album.ArtistId=u.artist.Id,r.album.Artist.Id=u.artist.Id,r.album.Artist.ArtistName=u.artist.ArtistName,r.updateAlbum(r.album),t.location.hash="/album/edit/0"},u.getArtist(n.artistId),a.addClass("#MainView","slide-animation")}angular.module("app").controller("artistController",e),e.$inject=["$http","$window","$routeParams","$animate","albumService"]}();
//# sourceMappingURL=app.min.js.map